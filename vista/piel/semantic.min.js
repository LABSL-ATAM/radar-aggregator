 /*
 * # Semantic UI - 2.1.4
 * https://github.com/Semantic-Org/Semantic-UI
 * http://www.semantic-ui.com/
 *
 * Copyright 2014 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,n,o){e.site=e.fn.site=function(i){var r,s,a=(new Date).getTime(),c=[],l=arguments[0],u="string"==typeof l,d=[].slice.call(arguments,1),f=e.isPlainObject(i)?e.extend(!0,{},e.site.settings,i):e.extend({},e.site.settings),m=f.namespace,g=f.error,p="module-"+m,v=e(n),b=v,h=this,y=b.data(p);return r={initialize:function(){r.instantiate()},instantiate:function(){r.verbose("Storing instance of site",r),y=r,b.data(p,r)},normalize:function(){r.fix.console(),r.fix.requestAnimationFrame()},fix:{console:function(){r.debug("Normalizing window.console"),(console===o||console.log===o)&&(r.verbose("Console not available, normalizing events"),r.disable.console()),("undefined"==typeof console.group||"undefined"==typeof console.groupEnd||"undefined"==typeof console.groupCollapsed)&&(r.verbose("Console group not available, normalizing events"),t.console.group=function(){},t.console.groupEnd=function(){},t.console.groupCollapsed=function(){}),"undefined"==typeof console.markTimeline&&(r.verbose("Mark timeline not available, normalizing events"),t.console.markTimeline=function(){})},consoleClear:function(){r.debug("Disabling programmatic console clearing"),t.console.clear=function(){}},requestAnimationFrame:function(){r.debug("Normalizing requestAnimationFrame"),t.requestAnimationFrame===o&&(r.debug("RequestAnimationFrame not available, normalizing event"),t.requestAnimationFrame=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)})}},moduleExists:function(t){return e.fn[t]!==o&&e.fn[t].settings!==o},enabled:{modules:function(t){var n=[];return t=t||f.modules,e.each(t,function(e,t){r.moduleExists(t)&&n.push(t)}),n}},disabled:{modules:function(t){var n=[];return t=t||f.modules,e.each(t,function(e,t){r.moduleExists(t)||n.push(t)}),n}},change:{setting:function(t,n,i,s){i="string"==typeof i?"all"===i?f.modules:[i]:i||f.modules,s=s!==o?s:!0,e.each(i,function(o,i){var a,c=r.moduleExists(i)?e.fn[i].settings.namespace||!1:!0;r.moduleExists(i)&&(r.verbose("Changing default setting",t,n,i),e.fn[i].settings[t]=n,s&&c&&(a=e(":data(module-"+c+")"),a.length>0&&(r.verbose("Modifying existing settings",a),a[i]("setting",t,n))))})},settings:function(t,n,i){n="string"==typeof n?[n]:n||f.modules,i=i!==o?i:!0,e.each(n,function(n,o){var s;r.moduleExists(o)&&(r.verbose("Changing default setting",t,o),e.extend(!0,e.fn[o].settings,t),i&&m&&(s=e(":data(module-"+m+")"),s.length>0&&(r.verbose("Modifying existing settings",s),s[o]("setting",t))))})}},enable:{console:function(){r.console(!0)},debug:function(e,t){e=e||f.modules,r.debug("Enabling debug for modules",e),r.change.setting("debug",!0,e,t)},verbose:function(e,t){e=e||f.modules,r.debug("Enabling verbose debug for modules",e),r.change.setting("verbose",!0,e,t)}},disable:{console:function(){r.console(!1)},debug:function(e,t){e=e||f.modules,r.debug("Disabling debug for modules",e),r.change.setting("debug",!1,e,t)},verbose:function(e,t){e=e||f.modules,r.debug("Disabling verbose debug for modules",e),r.change.setting("verbose",!1,e,t)}},console:function(e){if(e){if(y.cache.console===o)return void r.error(g.console);r.debug("Restoring console function"),t.console=y.cache.console}else r.debug("Disabling console function"),y.cache.console=t.console,t.console={clear:function(){},error:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},info:function(){},log:function(){},markTimeline:function(){},warn:function(){}}},destroy:function(){r.verbose("Destroying previous site for",b),b.removeData(p)},cache:{},setting:function(t,n){if(e.isPlainObject(t))e.extend(!0,f,t);else{if(n===o)return f[t];f[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,r,t);else{if(n===o)return r[t];r[t]=n}},debug:function(){f.debug&&(f.performance?r.performance.log(arguments):(r.debug=Function.prototype.bind.call(console.info,console,f.name+":"),r.debug.apply(console,arguments)))},verbose:function(){f.verbose&&f.debug&&(f.performance?r.performance.log(arguments):(r.verbose=Function.prototype.bind.call(console.info,console,f.name+":"),r.verbose.apply(console,arguments)))},error:function(){r.error=Function.prototype.bind.call(console.error,console,f.name+":"),r.error.apply(console,arguments)},performance:{log:function(e){var t,n,o;f.performance&&(t=(new Date).getTime(),o=a||t,n=t-o,a=t,c.push({Element:h,Name:e[0],Arguments:[].slice.call(e,1)||"","Execution Time":n})),clearTimeout(r.performance.timer),r.performance.timer=setTimeout(r.performance.display,500)},display:function(){var t=f.name+":",n=0;a=!1,clearTimeout(r.performance.timer),e.each(c,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",(console.group!==o||console.table!==o)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,n,i){var a,c,l,u=y;return n=n||d,i=h||i,"string"==typeof t&&u!==o&&(t=t.split(/[\. ]/),a=t.length-1,e.each(t,function(n,i){var s=n!=a?i+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(u[s])&&n!=a)u=u[s];else{if(u[s]!==o)return c=u[s],!1;if(!e.isPlainObject(u[i])||n==a)return u[i]!==o?(c=u[i],!1):(r.error(g.method,t),!1);u=u[i]}})),e.isFunction(c)?l=c.apply(i,n):c!==o&&(l=c),e.isArray(s)?s.push(l):s!==o?s=[s,l]:l!==o&&(s=l),c}},u?(y===o&&r.initialize(),r.invoke(l)):(y!==o&&r.destroy(),r.initialize()),s!==o?s:this},e.site.settings={name:"Site",namespace:"site",error:{console:"Console cannot be restored, most likely it was overwritten outside of module",method:"The method you called is not defined."},debug:!1,verbose:!1,performance:!0,modules:["accordion","api","checkbox","dimmer","dropdown","embed","form","modal","nag","popup","rating","shape","sidebar","state","sticky","tab","transition","visit","visibility"],siteNamespace:"site",namespaceStub:{cache:{},config:{},sections:{},section:{},utilities:{}}},e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,o){return!!e.data(t,o[3])}})}(jQuery,window,document),function(e,t,n,o){"use strict";e.fn.search=function(i){var r,s=e(this),a=s.selector||"",c=(new Date).getTime(),l=[],u=arguments[0],d="string"==typeof u,f=[].slice.call(arguments,1);return e(this).each(function(){var m,g=e.isPlainObject(i)?e.extend(!0,{},e.fn.search.settings,i):e.extend({},e.fn.search.settings),p=g.className,v=g.metadata,b=g.regExp,h=g.fields,y=g.selector,x=g.error,C=g.namespace,k="."+C,R=C+"-module",w=e(this),S=w.find(y.prompt),T=w.find(y.searchButton),P=w.find(y.results),E=(w.find(y.result),w.find(y.category),this),A=w.data(R);m={initialize:function(){m.verbose("Initializing module"),m.determine.searchFields(),m.bind.events(),m.set.type(),m.create.results(),m.instantiate()},instantiate:function(){m.verbose("Storing instance of module",m),A=m,w.data(R,m)},destroy:function(){m.verbose("Destroying instance"),w.off(k).removeData(R)},bind:{events:function(){m.verbose("Binding events to search"),g.automatic&&(w.on(m.get.inputEvent()+k,y.prompt,m.event.input),S.attr("autocomplete","off")),w.on("focus"+k,y.prompt,m.event.focus).on("blur"+k,y.prompt,m.event.blur).on("keydown"+k,y.prompt,m.handleKeyboard).on("click"+k,y.searchButton,m.query).on("mousedown"+k,y.results,m.event.result.mousedown).on("mouseup"+k,y.results,m.event.result.mouseup).on("click"+k,y.result,m.event.result.click)}},determine:{searchFields:function(){i&&i.searchFields!==o&&(g.searchFields=i.searchFields)}},event:{input:function(){clearTimeout(m.timer),m.timer=setTimeout(m.query,g.searchDelay)},focus:function(){m.set.focus(),m.has.minimumCharacters()&&(m.query(),m.can.show()&&m.showResults())},blur:function(e){var t=n.activeElement===this;t||m.resultsClicked||(m.cancel.query(),m.remove.focus(),m.timer=setTimeout(m.hideResults,g.hideDelay))},result:{mousedown:function(){m.resultsClicked=!0},mouseup:function(){m.resultsClicked=!1},click:function(n){m.debug("Search result selected");var o=e(this),i=o.find(y.title).eq(0),r=o.find("a[href]").eq(0),s=r.attr("href")||!1,a=r.attr("target")||!1,c=(i.html(),i.length>0?i.text():!1),l=m.get.results(),u=o.data(v.result)||m.get.result(c,l);return e.isFunction(g.onSelect)&&g.onSelect.call(E,u,l)===!1?void m.debug("Custom onSelect callback cancelled default select action"):(m.hideResults(),c&&m.set.value(c),void(s&&(m.verbose("Opening search link found in result",r),"_blank"==a||n.ctrlKey?t.open(s):t.location.href=s)))}}},handleKeyboard:function(e){var t,n=w.find(y.result),o=w.find(y.category),i=n.index(n.filter("."+p.active)),r=n.length,s=e.which,a={backspace:8,enter:13,escape:27,upArrow:38,downArrow:40};if(s==a.escape&&(m.verbose("Escape key pressed, blurring search field"),S.trigger("blur")),m.is.visible())if(s==a.enter){if(m.verbose("Enter key pressed, selecting active result"),n.filter("."+p.active).length>0)return m.event.result.click.call(n.filter("."+p.active),e),e.preventDefault(),!1}else s==a.upArrow?(m.verbose("Up key pressed, changing active result"),t=0>i-1?i:i-1,o.removeClass(p.active),n.removeClass(p.active).eq(t).addClass(p.active).closest(o).addClass(p.active),e.preventDefault()):s==a.downArrow&&(m.verbose("Down key pressed, changing active result"),t=i+1>=r?i:i+1,o.removeClass(p.active),n.removeClass(p.active).eq(t).addClass(p.active).closest(o).addClass(p.active),e.preventDefault());else s==a.enter&&(m.verbose("Enter key pressed, executing query"),m.query(),m.set.buttonPressed(),S.one("keyup",m.remove.buttonFocus))},setup:{api:function(){var e={debug:g.debug,on:!1,cache:"local",action:"search",onError:m.error};m.verbose("First request, initializing API"),w.api(e)}},can:{useAPI:function(){return e.fn.api!==o},show:function(){return m.is.focused()&&!m.is.visible()&&!m.is.empty()},transition:function(){return g.transition&&e.fn.transition!==o&&w.transition("is supported")}},is:{empty:function(){return""===P.html()},visible:function(){return P.filter(":visible").length>0},focused:function(){return S.filter(":focus").length>0}},get:{inputEvent:function(){var e=S[0],t=e!==o&&e.oninput!==o?"input":e!==o&&e.onpropertychange!==o?"propertychange":"keyup";return t},value:function(){return S.val()},results:function(){var e=w.data(v.results);return e},result:function(t,n){var i=["title","id"],r=!1;return t=t!==o?t:m.get.value(),n=n!==o?n:m.get.results(),"category"===g.type?(m.debug("Finding result that matches",t),e.each(n,function(n,o){return e.isArray(o.results)&&(r=m.search.object(t,o.results,i)[0])?!1:void 0})):(m.debug("Finding result in results object",t),r=m.search.object(t,n,i)[0]),r||!1}},set:{focus:function(){w.addClass(p.focus)},loading:function(){w.addClass(p.loading)},value:function(e){m.verbose("Setting search input value",e),S.val(e)},type:function(e){e=e||g.type,"category"==g.type&&w.addClass(g.type)},buttonPressed:function(){T.addClass(p.pressed)}},remove:{loading:function(){w.removeClass(p.loading)},focus:function(){w.removeClass(p.focus)},buttonPressed:function(){T.removeClass(p.pressed)}},query:function(){var t=m.get.value(),n=m.read.cache(t);m.has.minimumCharacters()?n?(m.debug("Reading result from cache",t),m.save.results(n.results),m.addResults(n.html),m.inject.id(n.results)):(m.debug("Querying for",t),e.isPlainObject(g.source)||e.isArray(g.source)?m.search.local(t):m.can.useAPI()?m.search.remote(t):m.error(x.source),g.onSearchQuery.call(E,t)):m.hideResults()},search:{local:function(e){var t,n=m.search.object(e,g.content);m.set.loading(),m.save.results(n),m.debug("Returned local search results",n),t=m.generateResults({results:n}),m.remove.loading(),m.addResults(t),m.inject.id(n),m.write.cache(e,{html:t,results:n})},remote:function(t){var n={onSuccess:function(e){m.parse.response.call(E,e,t)},onFailure:function(){m.displayMessage(x.serverError)},urlData:{query:t}};w.api("get request")||m.setup.api(),e.extend(!0,n,g.apiSettings),m.debug("Executing search",n),m.cancel.query(),w.api("setting",n).api("query")},object:function(t,n,i){var r=[],s=[],a=t.toString().replace(b.escape,"\\$&"),c=new RegExp(b.beginsWith+a,"i"),l=function(t,n){var o=-1==e.inArray(n,r),i=-1==e.inArray(n,s);o&&i&&t.push(n)};return n=n||g.source,i=i!==o?i:g.searchFields,e.isArray(i)||(i=[i]),n===o||n===!1?(m.error(x.source),[]):(e.each(i,function(o,i){e.each(n,function(e,n){var o="string"==typeof n[i];o&&(-1!==n[i].search(c)?l(r,n):g.searchFullText&&m.fuzzySearch(t,n[i])&&l(s,n))})}),e.merge(r,s))}},fuzzySearch:function(e,t){var n=t.length,o=e.length;if("string"!=typeof e)return!1;if(e=e.toLowerCase(),t=t.toLowerCase(),o>n)return!1;if(o===n)return e===t;e:for(var i=0,r=0;o>i;i++){for(var s=e.charCodeAt(i);n>r;)if(t.charCodeAt(r++)===s)continue e;return!1}return!0},parse:{response:function(e,t){var n=m.generateResults(e);m.verbose("Parsing server response",e),e!==o&&t!==o&&e[h.results]!==o&&(m.addResults(n),m.inject.id(e[h.results]),m.write.cache(t,{html:n,results:e[h.results]}),m.save.results(e[h.results]))}},cancel:{query:function(){m.can.useAPI()&&w.api("abort")}},has:{minimumCharacters:function(){var e=m.get.value(),t=e.length;return t>=g.minCharacters}},clear:{cache:function(e){var t=w.data(v.cache);e?e&&t&&t[e]&&(m.debug("Removing value from cache",e),delete t[e],w.data(v.cache,t)):(m.debug("Clearing cache",e),w.removeData(v.cache))}},read:{cache:function(e){var t=w.data(v.cache);return g.cache?(m.verbose("Checking cache for generated html for query",e),"object"==typeof t&&t[e]!==o?t[e]:!1):!1}},create:{id:function(e,t){var n,i,r=e+1;return t!==o?(n=String.fromCharCode(97+t),i=n+r,m.verbose("Creating category result id",i)):(i=r,m.verbose("Creating result id",i)),i},results:function(){0===P.length&&(P=e("<div />").addClass(p.results).appendTo(w))}},inject:{result:function(e,t,n){m.verbose("Injecting result into results");var i=n!==o?P.children().eq(n).children(y.result).eq(t):P.children(y.result).eq(t);m.verbose("Injecting results metadata",i),i.data(v.result,e)},id:function(t){m.debug("Injecting unique ids into results");var n=0,i=0;return"category"===g.type?e.each(t,function(t,r){i=0,e.each(r.results,function(e,t){var s=r.results[e];s.id===o&&(s.id=m.create.id(i,n)),m.inject.result(s,i,n),i++}),n++}):e.each(t,function(e,n){var r=t[e];r.id===o&&(r.id=m.create.id(i)),m.inject.result(r,i),i++}),t}},save:{results:function(e){m.verbose("Saving current search results to metadata",e),w.data(v.results,e)}},write:{cache:function(e,t){var n=w.data(v.cache)!==o?w.data(v.cache):{};g.cache&&(m.verbose("Writing generated html to cache",e,t),n[e]=t,w.data(v.cache,n))}},addResults:function(t){return e.isFunction(g.onResultsAdd)&&g.onResultsAdd.call(P,t)===!1?(m.debug("onResultsAdd callback cancelled default action"),!1):(P.html(t),void(m.can.show()&&m.showResults()))},showResults:function(){m.is.visible()||(m.can.transition()?(m.debug("Showing results with css animations"),P.transition({animation:g.transition+" in",debug:g.debug,verbose:g.verbose,duration:g.duration,queue:!0})):(m.debug("Showing results with javascript"),P.stop().fadeIn(g.duration,g.easing)),g.onResultsOpen.call(P))},hideResults:function(){m.is.visible()&&(m.can.transition()?(m.debug("Hiding results with css animations"),P.transition({animation:g.transition+" out",debug:g.debug,verbose:g.verbose,duration:g.duration,queue:!0})):(m.debug("Hiding results with javascript"),P.stop().fadeOut(g.duration,g.easing)),g.onResultsClose.call(P))},generateResults:function(t){m.debug("Generating html from response",t);var n=g.templates[g.type],o=e.isPlainObject(t[h.results])&&!e.isEmptyObject(t[h.results]),i=e.isArray(t[h.results])&&t[h.results].length>0,r="";return o||i?(g.maxResults>0&&(o?"standard"==g.type&&m.error(x.maxResults):t[h.results]=t[h.results].slice(0,g.maxResults)),e.isFunction(n)?r=n(t,h):m.error(x.noTemplate,!1)):r=m.displayMessage(x.noResults,"empty"),g.onResults.call(E,t),r},displayMessage:function(e,t){return t=t||"standard",m.debug("Displaying message",e,t),m.addResults(g.templates.message(e,t)),g.templates.message(e,t)},setting:function(t,n){if(e.isPlainObject(t))e.extend(!0,g,t);else{if(n===o)return g[t];g[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,m,t);else{if(n===o)return m[t];m[t]=n}},debug:function(){g.debug&&(g.performance?m.performance.log(arguments):(m.debug=Function.prototype.bind.call(console.info,console,g.name+":"),m.debug.apply(console,arguments)))},verbose:function(){g.verbose&&g.debug&&(g.performance?m.performance.log(arguments):(m.verbose=Function.prototype.bind.call(console.info,console,g.name+":"),m.verbose.apply(console,arguments)))},error:function(){m.error=Function.prototype.bind.call(console.error,console,g.name+":"),m.error.apply(console,arguments)},performance:{log:function(e){var t,n,o;g.performance&&(t=(new Date).getTime(),o=c||t,n=t-o,c=t,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:E,"Execution Time":n})),clearTimeout(m.performance.timer),m.performance.timer=setTimeout(m.performance.display,500)},display:function(){var t=g.name+":",n=0;c=!1,clearTimeout(m.performance.timer),e.each(l,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",a&&(t+=" '"+a+"'"),s.length>1&&(t+=" ("+s.length+")"),(console.group!==o||console.table!==o)&&l.length>0&&(console.groupCollapsed(t),console.table?console.table(l):e.each(l,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(t,n,i){var s,a,c,l=A;return n=n||f,i=E||i,"string"==typeof t&&l!==o&&(t=t.split(/[\. ]/),s=t.length-1,e.each(t,function(n,i){var r=n!=s?i+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(l[r])&&n!=s)l=l[r];else{if(l[r]!==o)return a=l[r],!1;if(!e.isPlainObject(l[i])||n==s)return l[i]!==o?(a=l[i],!1):!1;l=l[i]}})),e.isFunction(a)?c=a.apply(i,n):a!==o&&(c=a),e.isArray(r)?r.push(c):r!==o?r=[r,c]:c!==o&&(r=c),a}},d?(A===o&&m.initialize(),m.invoke(u)):(A!==o&&A.invoke("destroy"),m.initialize())}),r!==o?r:this},e.fn.search.settings={name:"Search",namespace:"search",debug:!1,verbose:!1,performance:!0,type:"standard",minCharacters:1,apiSettings:!1,source:!1,searchFields:["title","description"],displayField:"",searchFullText:!0,automatic:!0,hideDelay:0,searchDelay:200,maxResults:7,cache:!0,transition:"scale",duration:200,easing:"easeOutExpo",onSelect:!1,onResultsAdd:!1,onSearchQuery:function(e){},onResults:function(e){},onResultsOpen:function(){},onResultsClose:function(){},className:{active:"active",empty:"empty",focus:"focus",loading:"loading",results:"results",pressed:"down"},error:{source:"Cannot search. No source used, and Semantic API module was not included",noResults:"Your search returned no results",logging:"Error in debug logging, exiting.",noEndpoint:"No search endpoint was specified",noTemplate:"A valid template name was not specified.",serverError:"There was an issue querying the server.",maxResults:"Results must be an array to use maxResults setting",method:"The method you called is not defined."},metadata:{cache:"cache",results:"results",result:"result"},regExp:{escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,beginsWith:"(?:s|^)"},fields:{categories:"results",categoryName:"name",categoryResults:"results",description:"description",image:"image",price:"price",results:"results",title:"title",action:"action",actionText:"text",actionURL:"url"},selector:{prompt:".prompt",searchButton:".search.button",results:".results",category:".category",result:".result",title:".title, .name"},templates:{escape:function(e){var t=/[&<>"'`]/g,n=/[&<>"'`]/,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=function(e){return o[e]};return n.test(e)?e.replace(t,i):e},message:function(e,t){var n="";return e!==o&&t!==o&&(n+='<div class="message '+t+'">',n+="empty"==t?'<div class="header">No Results</div class="header"><div class="description">'+e+'</div class="description">':' <div class="description">'+e+"</div>",n+="</div>"),n},category:function(t,n){var i="";e.fn.search.settings.templates.escape;return t[n.categoryResults]!==o?(e.each(t[n.categoryResults],function(r,s){s[n.results]!==o&&s.results.length>0&&(i+='<div class="category">',s[n.categoryName]!==o&&(i+='<div class="name">'+s[n.categoryName]+"</div>"),e.each(s.results,function(e,r){i+=t[n.url]?'<a class="result" href="'+t[n.url]+'">':'<a class="result">',r[n.image]!==o&&(i+='<div class="image"> <img src="'+r[n.image]+'"></div>'),i+='<div class="content">',r[n.price]!==o&&(i+='<div class="price">'+r[n.price]+"</div>"),r[n.title]!==o&&(i+='<div class="title">'+r[n.title]+"</div>"),r[n.description]!==o&&(i+='<div class="description">'+r[n.description]+"</div>"),i+="</div>",i+="</a>"}),i+="</div>")}),t[n.action]&&(i+='<a href="'+t[n.action][n.actionURL]+'" class="action">'+t[n.action][n.actionText]+"</a>"),i):!1},standard:function(t,n){var i="";return t[n.results]!==o?(e.each(t[n.results],function(e,r){i+=t[n.url]?'<a class="result" href="'+t[n.url]+'">':'<a class="result">',r[n.image]!==o&&(i+='<div class="image"> <img src="'+r[n.image]+'"></div>'),i+='<div class="content">',r[n.price]!==o&&(i+='<div class="price">'+r[n.price]+"</div>"),r[n.title]!==o&&(i+='<div class="title">'+r[n.title]+"</div>"),r[n.description]!==o&&(i+='<div class="description">'+r[n.description]+"</div>"),i+="</div>",i+="</a>"}),t[n.action]&&(i+='<a href="'+t[n.action][n.actionURL]+'" class="action">'+t[n.action][n.actionText]+"</a>"),i):!1}}}}(jQuery,window,document),function(e,t,n,o){"use strict";e.fn.sticky=function(n){var i,r=e(this),s=r.selector||"",a=(new Date).getTime(),c=[],l=arguments[0],u="string"==typeof l,d=[].slice.call(arguments,1);return r.each(function(){var r,f,m,g,p=e.isPlainObject(n)?e.extend(!0,{},e.fn.sticky.settings,n):e.extend({},e.fn.sticky.settings),v=p.className,b=p.namespace,h=p.error,y="."+b,x="module-"+b,C=e(this),k=e(t),R=e(p.scrollContext),w=(C.selector||"",C.data(x)),S=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)},T=this;g={initialize:function(){g.determineContainer(),g.determineContext(),g.verbose("Initializing sticky",p,r),g.save.positions(),g.checkErrors(),g.bind.events(),p.observeChanges&&g.observeChanges(),g.instantiate()},instantiate:function(){g.verbose("Storing instance of module",g),w=g,C.data(x,g)},destroy:function(){g.verbose("Destroying previous instance"),g.reset(),m&&m.disconnect(),k.off("load"+y,g.event.load).off("resize"+y,g.event.resize),R.off("scrollchange"+y,g.event.scrollchange),C.removeData(x)},observeChanges:function(){var e=f[0];"MutationObserver"in t&&(m=new MutationObserver(function(e){clearTimeout(g.timer),g.timer=setTimeout(function(){g.verbose("DOM tree modified, updating sticky menu",e),g.refresh()},100)}),m.observe(T,{childList:!0,subtree:!0}),m.observe(e,{childList:!0,subtree:!0}),g.debug("Setting up mutation observer",m))},determineContainer:function(){r=C.offsetParent()},determineContext:function(){return f=p.context?e(p.context):r,0===f.length?void g.error(h.invalidContext,p.context,C):void 0},checkErrors:function(){return g.is.hidden()&&g.error(h.visible,C),g.cache.element.height>g.cache.context.height?(g.reset(),void g.error(h.elementSize,C)):void 0},bind:{events:function(){k.on("load"+y,g.event.load).on("resize"+y,g.event.resize),R.off("scroll"+y).on("scroll"+y,g.event.scroll).on("scrollchange"+y,g.event.scrollchange)}},event:{load:function(){g.verbose("Page contents finished loading"),S(g.refresh)},resize:function(){g.verbose("Window resized"),S(g.refresh)},scroll:function(){S(function(){R.triggerHandler("scrollchange"+y,R.scrollTop())})},scrollchange:function(e,t){g.stick(t),p.onScroll.call(T)}},refresh:function(e){g.reset(),p.context||g.determineContext(),e&&g.determineContainer(),g.save.positions(),g.stick(),p.onReposition.call(T)},supports:{sticky:function(){var t=e("<div/>");t[0];return t.addClass(v.supported),t.css("position").match("sticky")}},save:{lastScroll:function(e){g.lastScroll=e},elementScroll:function(e){g.elementScroll=e},positions:function(){var e={height:k.height()},t={margin:{top:parseInt(C.css("margin-top"),10),bottom:parseInt(C.css("margin-bottom"),10)},offset:C.offset(),width:C.outerWidth(),height:C.outerHeight()},n={offset:f.offset(),height:f.outerHeight()};({height:r.outerHeight()});g.cache={fits:t.height<e.height,window:{height:e.height},element:{margin:t.margin,top:t.offset.top-t.margin.top,left:t.offset.left,width:t.width,height:t.height,bottom:t.offset.top+t.height},context:{top:n.offset.top,height:n.height,bottom:n.offset.top+n.height}},g.set.containerSize(),g.set.size(),g.stick(),g.debug("Caching element positions",g.cache)}},get:{direction:function(e){var t="down";return e=e||R.scrollTop(),g.lastScroll!==o&&(g.lastScroll<e?t="down":g.lastScroll>e&&(t="up")),t},scrollChange:function(e){return e=e||R.scrollTop(),g.lastScroll?e-g.lastScroll:0},currentElementScroll:function(){return g.elementScroll?g.elementScroll:g.is.top()?Math.abs(parseInt(C.css("top"),10))||0:Math.abs(parseInt(C.css("bottom"),10))||0},elementScroll:function(e){e=e||R.scrollTop();var t=g.cache.element,n=g.cache.window,o=g.get.scrollChange(e),i=t.height-n.height+p.offset,r=g.get.currentElementScroll(),s=r+o;return r=g.cache.fits||0>s?0:s>i?i:s}},remove:{lastScroll:function(){delete g.lastScroll},elementScroll:function(e){delete g.elementScroll},offset:function(){C.css("margin-top","")}},set:{offset:function(){g.verbose("Setting offset on element",p.offset),C.css("margin-top",p.offset)},containerSize:function(){var e=r.get(0).tagName;"HTML"===e||"body"==e?g.determineContainer():Math.abs(r.outerHeight()-g.cache.context.height)>p.jitter&&(g.debug("Context has padding, specifying exact height for container",g.cache.context.height),r.css({height:g.cache.context.height}))},minimumSize:function(){var e=g.cache.element;r.css("min-height",e.height)},scroll:function(e){g.debug("Setting scroll on element",e),g.elementScroll!=e&&(g.is.top()&&C.css("bottom","").css("top",-e),g.is.bottom()&&C.css("top","").css("bottom",e))},size:function(){0!==g.cache.element.height&&0!==g.cache.element.width&&(T.style.setProperty("width",g.cache.element.width+"px","important"),T.style.setProperty("height",g.cache.element.height+"px","important"))}},is:{top:function(){return C.hasClass(v.top)},bottom:function(){return C.hasClass(v.bottom)},initialPosition:function(){return!g.is.fixed()&&!g.is.bound()},hidden:function(){return!C.is(":visible")},bound:function(){return C.hasClass(v.bound)},fixed:function(){return C.hasClass(v.fixed)}},stick:function(e){var t=e||R.scrollTop(),n=g.cache,o=n.fits,i=n.element,r=n.window,s=n.context,a=g.is.bottom()&&p.pushing?p.bottomOffset:p.offset,e={top:t+a,bottom:t+a+r.height},c=(g.get.direction(e.top),o?0:g.get.elementScroll(e.top)),l=!o,u=0!==i.height;u&&(g.is.initialPosition()?e.top>=s.bottom?(g.debug("Initial element position is bottom of container"),g.bindBottom()):e.top>i.top&&(i.height+e.top-c>=s.bottom?(g.debug("Initial element position is bottom of container"),g.bindBottom()):(g.debug("Initial element position is fixed"),g.fixTop())):g.is.fixed()?g.is.top()?e.top<=i.top?(g.debug("Fixed element reached top of container"),g.setInitialPosition()):i.height+e.top-c>=s.bottom?(g.debug("Fixed element reached bottom of container"),g.bindBottom()):l&&(g.set.scroll(c),g.save.lastScroll(e.top),g.save.elementScroll(c)):g.is.bottom()&&(e.bottom-i.height<=i.top?(g.debug("Bottom fixed rail has reached top of container"),g.setInitialPosition()):e.bottom>=s.bottom?(g.debug("Bottom fixed rail has reached bottom of container"),g.bindBottom()):l&&(g.set.scroll(c),g.save.lastScroll(e.top),g.save.elementScroll(c))):g.is.bottom()&&(p.pushing?g.is.bound()&&e.bottom<=s.bottom&&(g.debug("Fixing bottom attached element to bottom of browser."),g.fixBottom()):g.is.bound()&&e.top<=s.bottom-i.height&&(g.debug("Fixing bottom attached element to top of browser."),g.fixTop())))},bindTop:function(){g.debug("Binding element to top of parent container"),g.remove.offset(),C.css({left:"",top:"",marginBottom:""}).removeClass(v.fixed).removeClass(v.bottom).addClass(v.bound).addClass(v.top),p.onTop.call(T),p.onUnstick.call(T)},bindBottom:function(){g.debug("Binding element to bottom of parent container"),g.remove.offset(),C.css({left:"",top:""}).removeClass(v.fixed).removeClass(v.top).addClass(v.bound).addClass(v.bottom),p.onBottom.call(T),p.onUnstick.call(T)},setInitialPosition:function(){g.debug("Returning to initial position"),g.unfix(),g.unbind()},fixTop:function(){g.debug("Fixing element to top of page"),g.set.minimumSize(),g.set.offset(),C.css({left:g.cache.element.left,bottom:"",marginBottom:""}).removeClass(v.bound).removeClass(v.bottom).addClass(v.fixed).addClass(v.top),p.onStick.call(T)},fixBottom:function(){g.debug("Sticking element to bottom of page"),g.set.minimumSize(),g.set.offset(),C.css({left:g.cache.element.left,bottom:"",marginBottom:""}).removeClass(v.bound).removeClass(v.top).addClass(v.fixed).addClass(v.bottom),p.onStick.call(T)},unbind:function(){g.is.bound()&&(g.debug("Removing container bound position on element"),g.remove.offset(),C.removeClass(v.bound).removeClass(v.top).removeClass(v.bottom))},unfix:function(){g.is.fixed()&&(g.debug("Removing fixed position on element"),g.remove.offset(),C.removeClass(v.fixed).removeClass(v.top).removeClass(v.bottom),p.onUnstick.call(T))},reset:function(){g.debug("Reseting elements position"),g.unbind(),g.unfix(),g.resetCSS(),g.remove.offset(),g.remove.lastScroll()},resetCSS:function(){C.css({width:"",height:""}),r.css({height:""})},setting:function(t,n){if(e.isPlainObject(t))e.extend(!0,p,t);else{if(n===o)return p[t];p[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,g,t);else{if(n===o)return g[t];g[t]=n}},debug:function(){p.debug&&(p.performance?g.performance.log(arguments):(g.debug=Function.prototype.bind.call(console.info,console,p.name+":"),g.debug.apply(console,arguments)))},verbose:function(){p.verbose&&p.debug&&(p.performance?g.performance.log(arguments):(g.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),g.verbose.apply(console,arguments)))},error:function(){g.error=Function.prototype.bind.call(console.error,console,p.name+":"),g.error.apply(console,arguments)},performance:{log:function(e){var t,n,o;p.performance&&(t=(new Date).getTime(),o=a||t,n=t-o,a=t,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:T,"Execution Time":n})),clearTimeout(g.performance.timer),g.performance.timer=setTimeout(g.performance.display,0)},display:function(){var t=p.name+":",n=0;a=!1,clearTimeout(g.performance.timer),e.each(c,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",s&&(t+=" '"+s+"'"),(console.group!==o||console.table!==o)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,n,r){var s,a,c,l=w;return n=n||d,r=T||r,"string"==typeof t&&l!==o&&(t=t.split(/[\. ]/),s=t.length-1,e.each(t,function(n,i){var r=n!=s?i+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(l[r])&&n!=s)l=l[r];else{if(l[r]!==o)return a=l[r],!1;if(!e.isPlainObject(l[i])||n==s)return l[i]!==o?(a=l[i],!1):!1;l=l[i]}})),e.isFunction(a)?c=a.apply(r,n):a!==o&&(c=a),e.isArray(i)?i.push(c):i!==o?i=[i,c]:c!==o&&(i=c),a}},u?(w===o&&g.initialize(),g.invoke(l)):(w!==o&&w.invoke("destroy"),g.initialize())}),i!==o?i:this},e.fn.sticky.settings={name:"Sticky",namespace:"sticky",debug:!1,verbose:!0,performance:!0,pushing:!1,context:!1,scrollContext:t,offset:0,bottomOffset:0,jitter:5,observeChanges:!1,onReposition:function(){},onScroll:function(){},onStick:function(){},onUnstick:function(){},onTop:function(){},onBottom:function(){},error:{container:"Sticky element must be inside a relative container",visible:"Element is hidden, you must call refresh after element becomes visible",method:"The method you called is not defined.",invalidContext:"Context specified does not exist",elementSize:"Sticky element is larger than its container, cannot create sticky."
},className:{bound:"bound",fixed:"fixed",supported:"native",top:"top",bottom:"bottom"}}}(jQuery,window,document),function(e,t,n,o){"use strict";e.api=e.fn.api=function(n){var i,r=e(e.isFunction(this)?t:this),s=r.selector||"",a=(new Date).getTime(),c=[],l=arguments[0],u="string"==typeof l,d=[].slice.call(arguments,1);return r.each(function(){var r,f,m,g,p,v,b=e.isPlainObject(n)?e.extend(!0,{},e.fn.api.settings,n):e.extend({},e.fn.api.settings),h=b.namespace,y=b.metadata,x=b.selector,C=b.error,k=b.className,R="."+h,w="module-"+h,S=e(this),T=S.closest(x.form),P=b.stateContext?e(b.stateContext):S,E=this,A=P[0],q=S.data(w);v={initialize:function(){u||v.bind.events(),v.instantiate()},instantiate:function(){v.verbose("Storing instance of module",v),q=v,S.data(w,q)},destroy:function(){v.verbose("Destroying previous module for",E),S.removeData(w).off(R)},bind:{events:function(){var e=v.get.event();e?(v.verbose("Attaching API events to element",e),S.on(e+R,v.event.trigger)):"now"==b.on&&(v.debug("Querying API endpoint immediately"),v.query())}},decode:{json:function(e){if(e!==o&&"string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}},read:{cachedResponse:function(e){var n;return t.Storage===o?void v.error(C.noStorage):(n=sessionStorage.getItem(e),v.debug("Using cached response",e,n),n=v.decode.json(n),!1)}},write:{cachedResponse:function(n,i){return i&&""===i?void v.debug("Response empty, not caching",i):t.Storage===o?void v.error(C.noStorage):(e.isPlainObject(i)&&(i=JSON.stringify(i)),sessionStorage.setItem(n,i),void v.verbose("Storing cached response for url",n,i))}},query:function(){if(v.is.disabled())return void v.debug("Element is disabled API request aborted");if(v.is.loading()){if(!b.interruptRequests)return void v.debug("Cancelling request, previous request is still pending");v.debug("Interrupting previous request"),v.abort()}return b.defaultData&&e.extend(!0,b.urlData,v.get.defaultData()),b.serializeForm&&(b.data=v.add.formData(b.data)),f=v.get.settings(),f===!1?(v.cancelled=!0,void v.error(C.beforeSend)):(v.cancelled=!1,m=v.get.templatedURL(),m||v.is.mocked()?(m=v.add.urlData(m),m||v.is.mocked()?(r=e.extend(!0,{},b,{type:b.method||b.type,data:g,url:b.base+m,beforeSend:b.beforeXHR,success:function(){},failure:function(){},complete:function(){}}),v.debug("Querying URL",r.url),v.verbose("Using AJAX settings",r),"local"===b.cache&&v.read.cachedResponse(m)?(v.debug("Response returned from local cache"),v.request=v.create.request(),void v.request.resolveWith(A,[v.read.cachedResponse(m)])):void(b.throttle?b.throttleFirstRequest||v.timer?(v.debug("Throttling request",b.throttle),clearTimeout(v.timer),v.timer=setTimeout(function(){v.timer&&delete v.timer,v.debug("Sending throttled request",g,r.method),v.send.request()},b.throttle)):(v.debug("Sending request",g,r.method),v.send.request(),v.timer=setTimeout(function(){},b.throttle)):(v.debug("Sending request",g,r.method),v.send.request()))):void 0):void v.error(C.missingURL))},should:{removeError:function(){return b.hideError===!0||"auto"===b.hideError&&!v.is.form()}},is:{disabled:function(){return S.filter(x.disabled).length>0},form:function(){return S.is("form")||P.is("form")},mocked:function(){return b.mockResponse||b.mockResponseAsync},input:function(){return S.is("input")},loading:function(){return v.request&&"pending"==v.request.state()},abortedRequest:function(e){return e&&e.readyState!==o&&0===e.readyState?(v.verbose("XHR request determined to be aborted"),!0):(v.verbose("XHR request was not aborted"),!1)},validResponse:function(t){return"json"!==b.dataType&&"jsonp"!==b.dataType||!e.isFunction(b.successTest)?(v.verbose("Response is not JSON, skipping validation",b.successTest,t),!0):(v.debug("Checking JSON returned success",b.successTest,t),b.successTest(t)?(v.debug("Response passed success test",t),!0):(v.debug("Response failed success test",t),!1))}},was:{cancelled:function(){return v.cancelled||!1},succesful:function(){return v.request&&"resolved"==v.request.state()},failure:function(){return v.request&&"rejected"==v.request.state()},complete:function(){return v.request&&("resolved"==v.request.state()||"rejected"==v.request.state())}},add:{urlData:function(t,n){var i,r;return t&&(i=t.match(b.regExp.required),r=t.match(b.regExp.optional),n=n||b.urlData,i&&(v.debug("Looking for required URL variables",i),e.each(i,function(i,r){var s=-1!==r.indexOf("$")?r.substr(2,r.length-3):r.substr(1,r.length-2),a=e.isPlainObject(n)&&n[s]!==o?n[s]:S.data(s)!==o?S.data(s):P.data(s)!==o?P.data(s):n[s];return a===o?(v.error(C.requiredParameter,s,t),t=!1,!1):(v.verbose("Found required variable",s,a),a=b.encodeParameters?v.get.urlEncodedValue(a):a,t=t.replace(r,a),void 0)})),r&&(v.debug("Looking for optional URL variables",i),e.each(r,function(i,r){var s=-1!==r.indexOf("$")?r.substr(3,r.length-4):r.substr(2,r.length-3),a=e.isPlainObject(n)&&n[s]!==o?n[s]:S.data(s)!==o?S.data(s):P.data(s)!==o?P.data(s):n[s];a!==o?(v.verbose("Optional variable Found",s,a),t=t.replace(r,a)):(v.verbose("Optional variable not found",s),t=-1!==t.indexOf("/"+r)?t.replace("/"+r,""):t.replace(r,""))}))),t},formData:function(t){var n,i=e.fn.serializeObject!==o,r=i?T.serializeObject():T.serialize();return t=t||b.data,n=e.isPlainObject(t),n?i?(v.debug("Extending existing data with form data",t,r),t=e.extend(!0,{},t,r)):(v.error(C.missingSerialize),v.debug("Cant extend data. Replacing data with form data",t,r),t=r):(v.debug("Adding form data",r),t=r),t}},send:{request:function(){v.set.loading(),v.request=v.create.request(),v.is.mocked()?v.mockedXHR=v.create.mockedXHR():v.xhr=v.create.xhr(),b.onRequest.call(A,v.request,v.xhr)}},event:{trigger:function(e){v.query(),("submit"==e.type||"click"==e.type)&&e.preventDefault()},xhr:{always:function(){},done:function(t,n,o){var i=this,r=(new Date).getTime()-p,s=b.loadingDuration-r,a=e.isFunction(b.onResponse)?b.onResponse.call(i,e.extend(!0,{},t)):!1;s=s>0?s:0,a&&(v.debug("Modified API response in onResponse callback",b.onResponse,a,t),t=a),s>0&&v.debug("Response completed early delaying state change by",s),setTimeout(function(){v.is.validResponse(t)?v.request.resolveWith(i,[t,o]):v.request.rejectWith(i,[o,"invalid"])},s)},fail:function(e,t,n){var o=this,i=(new Date).getTime()-p,r=b.loadingDuration-i;r=r>0?r:0,r>0&&v.debug("Response completed early delaying state change by",r),setTimeout(function(){v.is.abortedRequest(e)?v.request.rejectWith(o,[e,"aborted",n]):v.request.rejectWith(o,[e,"error",t,n])},r)}},request:{done:function(e,t){v.debug("Successful API Response",e),"local"===b.cache&&m&&(v.write.cachedResponse(m,e),v.debug("Saving server response locally",v.cache)),b.onSuccess.call(A,e,S,t)},complete:function(e,t){var n,o;v.was.succesful()?(o=e,n=t):(n=e,o=v.get.responseFromXHR(n)),v.remove.loading(),b.onComplete.call(A,o,S,n)},fail:function(e,t,n){var i=v.get.responseFromXHR(e),s=v.get.errorFromRequest(i,t,n);"aborted"==t?(v.debug("XHR Aborted (Most likely caused by page navigation or CORS Policy)",t,n),b.onAbort.call(A,t,S,e)):"invalid"==t?v.debug("JSON did not pass success test. A server-side error has most likely occurred",i):"error"==t&&e!==o&&(v.debug("XHR produced a server error",t,n),200!=e.status&&n!==o&&""!==n&&v.error(C.statusMessage+n,r.url),b.onError.call(A,s,S,e)),b.errorDuration&&"aborted"!==t&&(v.debug("Adding error state"),v.set.error(),v.should.removeError()&&setTimeout(v.remove.error,b.errorDuration)),v.debug("API Request failed",s,e),b.onFailure.call(A,i,S,e)}}},create:{request:function(){return e.Deferred().always(v.event.request.complete).done(v.event.request.done).fail(v.event.request.fail)},mockedXHR:function(){var t,n,o,i=!1,r=!1,s=!1;return o=e.Deferred().always(v.event.xhr.complete).done(v.event.xhr.done).fail(v.event.xhr.fail),b.mockResponse?(e.isFunction(b.mockResponse)?(v.debug("Using mocked callback returning response",b.mockResponse),n=b.mockResponse.call(A,b)):(v.debug("Using specified response",b.mockResponse),n=b.mockResponse),o.resolveWith(A,[n,i,{responseText:n}])):e.isFunction(b.mockResponseAsync)&&(t=function(e){v.debug("Async callback returned response",e),e?o.resolveWith(A,[e,i,{responseText:e}]):o.rejectWith(A,[{responseText:e},r,s])},v.debug("Using async mocked response",b.mockResponseAsync),b.mockResponseAsync.call(A,b,t)),o},xhr:function(){var t;return t=e.ajax(r).always(v.event.xhr.always).done(v.event.xhr.done).fail(v.event.xhr.fail),v.verbose("Created server request",t),t}},set:{error:function(){v.verbose("Adding error state to element",P),P.addClass(k.error)},loading:function(){v.verbose("Adding loading state to element",P),P.addClass(k.loading),p=(new Date).getTime()}},remove:{error:function(){v.verbose("Removing error state from element",P),P.removeClass(k.error)},loading:function(){v.verbose("Removing loading state from element",P),P.removeClass(k.loading)}},get:{responseFromXHR:function(t){return e.isPlainObject(t)?"json"==b.dataType||"jsonp"==b.dataType?v.decode.json(t.responseText):t.responseText:!1},errorFromRequest:function(t,n,i){return e.isPlainObject(t)&&t.error!==o?t.error:b.error[n]!==o?b.error[n]:i},request:function(){return v.request||!1},xhr:function(){return v.xhr||!1},settings:function(){var e;return e=b.beforeSend.call(A,b),e&&(e.success!==o&&(v.debug("Legacy success callback detected",e),v.error(C.legacyParameters,e.success),e.onSuccess=e.success),e.failure!==o&&(v.debug("Legacy failure callback detected",e),v.error(C.legacyParameters,e.failure),e.onFailure=e.failure),e.complete!==o&&(v.debug("Legacy complete callback detected",e),v.error(C.legacyParameters,e.complete),e.onComplete=e.complete)),e===o&&v.error(C.noReturnedValue),e!==o?e:b},urlEncodedValue:function(e){var n=t.decodeURIComponent(e),o=t.encodeURIComponent(e),i=n!==e;return i?(v.debug("URL value is already encoded, avoiding double encoding",e),e):(v.verbose("Encoding value using encodeURIComponent",e,o),o)},defaultData:function(){var t={};return e.isWindow(E)||(v.is.input()?t.value=S.val():v.is.form()&&(t.text=S.text())),t},event:function(){return e.isWindow(E)||"now"==b.on?(v.debug("API called without element, no events attached"),!1):"auto"==b.on?S.is("input")?E.oninput!==o?"input":E.onpropertychange!==o?"propertychange":"keyup":S.is("form")?"submit":"click":b.on},templatedURL:function(e){if(e=e||S.data(y.action)||b.action||!1,m=S.data(y.url)||b.url||!1)return v.debug("Using specified url",m),m;if(e){if(v.debug("Looking up url for action",e,b.api),b.api[e]===o&&!v.is.mocked())return void v.error(C.missingAction,b.action,b.api);m=b.api[e]}else v.is.form()&&(m=S.attr("action")||P.attr("action")||!1,v.debug("No url or action specified, defaulting to form action",m));return m}},abort:function(){var e=v.get.xhr();e&&"resolved"!==e.state()&&(v.debug("Cancelling API request"),e.abort())},reset:function(){v.remove.error(),v.remove.loading()},setting:function(t,n){if(v.debug("Changing setting",t,n),e.isPlainObject(t))e.extend(!0,b,t);else{if(n===o)return b[t];b[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,v,t);else{if(n===o)return v[t];v[t]=n}},debug:function(){b.debug&&(b.performance?v.performance.log(arguments):(v.debug=Function.prototype.bind.call(console.info,console,b.name+":"),v.debug.apply(console,arguments)))},verbose:function(){b.verbose&&b.debug&&(b.performance?v.performance.log(arguments):(v.verbose=Function.prototype.bind.call(console.info,console,b.name+":"),v.verbose.apply(console,arguments)))},error:function(){v.error=Function.prototype.bind.call(console.error,console,b.name+":"),v.error.apply(console,arguments)},performance:{log:function(e){var t,n,o;b.performance&&(t=(new Date).getTime(),o=a||t,n=t-o,a=t,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"","Execution Time":n})),clearTimeout(v.performance.timer),v.performance.timer=setTimeout(v.performance.display,500)},display:function(){var t=b.name+":",n=0;a=!1,clearTimeout(v.performance.timer),e.each(c,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",s&&(t+=" '"+s+"'"),(console.group!==o||console.table!==o)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,n,r){var s,a,c,l=q;return n=n||d,r=E||r,"string"==typeof t&&l!==o&&(t=t.split(/[\. ]/),s=t.length-1,e.each(t,function(n,i){var r=n!=s?i+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(l[r])&&n!=s)l=l[r];else{if(l[r]!==o)return a=l[r],!1;if(!e.isPlainObject(l[i])||n==s)return l[i]!==o?(a=l[i],!1):(v.error(C.method,t),!1);l=l[i]}})),e.isFunction(a)?c=a.apply(r,n):a!==o&&(c=a),e.isArray(i)?i.push(c):i!==o?i=[i,c]:c!==o&&(i=c),a}},u?(q===o&&v.initialize(),v.invoke(l)):(q!==o&&q.invoke("destroy"),v.initialize())}),i!==o?i:this},e.api.settings={name:"API",namespace:"api",debug:!1,verbose:!1,performance:!0,api:{},cache:!0,interruptRequests:!0,on:"auto",stateContext:!1,loadingDuration:0,hideError:"auto",errorDuration:2e3,encodeParameters:!0,action:!1,url:!1,base:"",urlData:{},defaultData:!0,serializeForm:!1,throttle:0,throttleFirstRequest:!0,method:"get",data:{},dataType:"json",mockResponse:!1,mockResponseAsync:!1,beforeSend:function(e){return e},beforeXHR:function(e){},onRequest:function(e,t){},onResponse:!1,onSuccess:function(e,t){},onComplete:function(e,t){},onFailure:function(e,t){},onError:function(e,t){},onAbort:function(e,t){},successTest:!1,error:{beforeSend:"The before send function has aborted the request",error:"There was an error with your request",exitConditions:"API Request Aborted. Exit conditions met",JSONParse:"JSON could not be parsed during error handling",legacyParameters:"You are using legacy API success callback names",method:"The method you called is not defined",missingAction:"API action used but no url was defined",missingSerialize:"jquery-serialize-object is required to add form data to an existing data object",missingURL:"No URL specified for api event",noReturnedValue:"The beforeSend callback must return a settings object, beforeSend ignored.",noStorage:"Caching responses locally requires session storage",parseError:"There was an error parsing your request",requiredParameter:"Missing a required URL parameter: ",statusMessage:"Server gave an error: ",timeout:"Your request timed out"},regExp:{required:/\{\$*[A-z0-9]+\}/g,optional:/\{\/\$*[A-z0-9]+\}/g},className:{loading:"loading",error:"error"},selector:{disabled:".disabled",form:"form"},metadata:{action:"action",url:"url"}}}(jQuery,window,document),function(e,t,n,o){"use strict";e.fn.form=function(t){var i,r=e(this),s=r.selector||"",a=(new Date).getTime(),c=[],l=arguments[0],u=arguments[1],d="string"==typeof l,f=[].slice.call(arguments,1);return r.each(function(){var m,g,p,v,b,h,y,x,C,k,R,w,S,T,P,E,A,q,F=e(this),j=this,O=[],z=!1;q={initialize:function(){q.get.settings(),d?(A===o&&q.instantiate(),q.invoke(l)):(q.verbose("Initializing form validation",F,x),q.bindEvents(),q.set.defaults(),q.instantiate())},instantiate:function(){q.verbose("Storing instance of module",q),A=q,F.data(P,q)},destroy:function(){q.verbose("Destroying previous module",A),q.removeEvents(),F.removeData(P)},refresh:function(){q.verbose("Refreshing selector cache"),m=F.find(R.field),g=F.find(R.group),p=F.find(R.message),v=F.find(R.prompt),b=F.find(R.submit),h=F.find(R.clear),y=F.find(R.reset)},submit:function(){q.verbose("Submitting form",F),F.submit()},attachEvents:function(t,n){n=n||"submit",e(t).on("click"+E,function(e){q[n](),e.preventDefault()})},bindEvents:function(){q.verbose("Attaching form events"),F.on("submit"+E,q.validate.form).on("blur"+E,R.field,q.event.field.blur).on("click"+E,R.submit,q.submit).on("click"+E,R.reset,q.reset).on("click"+E,R.clear,q.clear),x.keyboardShortcuts&&F.on("keydown"+E,R.field,q.event.field.keydown),m.each(function(){var t=e(this),n=t.prop("type"),o=q.get.changeEvent(n,t);e(this).on(o+E,q.event.field.change)})},clear:function(){m.each(function(){var t=e(this),n=t.parent(),o=t.closest(g),i=o.find(R.prompt),r=t.data(k.defaultValue)||"",s=n.is(R.uiCheckbox),a=n.is(R.uiDropdown),c=o.hasClass(w.error);c&&(q.verbose("Resetting error on field",o),o.removeClass(w.error),i.remove()),a?(q.verbose("Resetting dropdown value",n,r),n.dropdown("clear")):s?t.prop("checked",!1):(q.verbose("Resetting field value",t,r),t.val(""))})},reset:function(){m.each(function(){var t=e(this),n=t.parent(),i=t.closest(g),r=i.find(R.prompt),s=t.data(k.defaultValue),a=n.is(R.uiCheckbox),c=n.is(R.uiDropdown),l=i.hasClass(w.error);s!==o&&(l&&(q.verbose("Resetting error on field",i),i.removeClass(w.error),r.remove()),c?(q.verbose("Resetting dropdown value",n,s),n.dropdown("restore defaults")):a?(q.verbose("Resetting checkbox value",n,s),t.prop("checked",s)):(q.verbose("Resetting field value",t,s),t.val(s)))})},is:{bracketedRule:function(e){return e.type&&e.type.match(x.regExp.bracket)},valid:function(){var t=!0;return q.verbose("Checking if form is valid"),e.each(C,function(e,n){q.validate.field(n,e)||(t=!1)}),t}},removeEvents:function(){F.off(E),m.off(E),b.off(E),m.off(E)},event:{field:{keydown:function(t){var n=e(this),o=t.which,i={enter:13,escape:27};o==i.escape&&(q.verbose("Escape key pressed blurring field"),n.blur()),!t.ctrlKey&&o==i.enter&&n.is(R.input)&&n.not(R.checkbox).length>0&&(z||(n.one("keyup"+E,q.event.field.keyup),q.submit(),q.debug("Enter pressed on input submitting form")),z=!0)},keyup:function(){z=!1},blur:function(t){var n=e(this),o=n.closest(g),i=q.get.validation(n);o.hasClass(w.error)?(q.debug("Revalidating field",n,i),q.validate.form.call(q,t,!0)):("blur"==x.on||"change"==x.on)&&q.validate.field(i)},change:function(t){var n=e(this),o=n.closest(g);("change"==x.on||o.hasClass(w.error)&&x.revalidate)&&(clearTimeout(q.timer),q.timer=setTimeout(function(){q.debug("Revalidating field",n,q.get.validation(n)),q.validate.form.call(q,t,!0)},x.delay))}}},get:{ancillaryValue:function(e){return e.type&&q.is.bracketedRule(e)?e.type.match(x.regExp.bracket)[1]+"":!1},ruleName:function(e){return q.is.bracketedRule(e)?e.type.replace(e.type.match(x.regExp.bracket)[0],""):e.type},changeEvent:function(e,t){return"checkbox"==e||"radio"==e||"hidden"==e||t.is("select")?"change":q.get.inputEvent()},inputEvent:function(){return n.createElement("input").oninput!==o?"input":n.createElement("input").onpropertychange!==o?"propertychange":"keyup"},prompt:function(e,t){var n,o,i,r=q.get.ruleName(e),s=q.get.ancillaryValue(e),a=e.prompt||x.prompt[r]||x.text.unspecifiedRule,c=-1!==a.search("{value}"),l=-1!==a.search("{name}");return(l||c)&&(o=q.get.field(t.identifier)),c&&(a=a.replace("{value}",o.val())),l&&(n=o.closest(R.group).find("label").eq(0),i=1==n.size()?n.text():o.prop("placeholder")||x.text.unspecifiedField,a=a.replace("{name}",i)),a=a.replace("{identifier}",t.identifier),a=a.replace("{ruleValue}",s),e.prompt||q.verbose("Using default validation prompt for type",a,r),a},settings:function(){if(e.isPlainObject(t)){var n,i=Object.keys(t),r=i.length>0?t[i[0]].identifier!==o&&t[i[0]].rules!==o:!1;r?(x=e.extend(!0,{},e.fn.form.settings,u),C=e.extend({},e.fn.form.settings.defaults,t),q.error(x.error.oldSyntax,j),q.verbose("Extending settings from legacy parameters",C,x)):(t.fields&&(n=Object.keys(t.fields),("string"==typeof t.fields[n[0]]||e.isArray(t.fields[n[0]]))&&e.each(t.fields,function(n,o){"string"==typeof o&&(o=[o]),t.fields[n]={rules:[]},e.each(o,function(e,o){t.fields[n].rules.push({type:o})})})),x=e.extend(!0,{},e.fn.form.settings,t),C=e.extend({},e.fn.form.settings.defaults,x.fields),q.verbose("Extending settings",C,x))}else x=e.fn.form.settings,C=e.fn.form.settings.defaults,q.verbose("Using default form validation",C,x);T=x.namespace,k=x.metadata,R=x.selector,w=x.className,S=x.error,P="module-"+T,E="."+T,A=F.data(P),q.refresh()},field:function(t){return q.verbose("Finding field with identifier",t),m.filter("#"+t).length>0?m.filter("#"+t):m.filter('[name="'+t+'"]').length>0?m.filter('[name="'+t+'"]'):m.filter('[name="'+t+'[]"]').length>0?m.filter('[name="'+t+'[]"]'):m.filter("[data-"+k.validate+'="'+t+'"]').length>0?m.filter("[data-"+k.validate+'="'+t+'"]'):e("<input/>")},fields:function(t){var n=e();return e.each(t,function(e,t){n=n.add(q.get.field(t))}),n},validation:function(t){var n,o;return C?(e.each(C,function(e,i){o=i.identifier||e,q.get.field(o)[0]==t[0]&&(i.identifier=o,n=i)}),n||!1):!1},value:function(e){var t,n=[];return n.push(e),t=q.get.values.call(j,n),t[e]},values:function(t){var n=e.isArray(t)?q.get.fields(t):m,o={};return n.each(function(t,n){var i=e(n),r=(i.prop("type"),i.prop("name")),s=i.val(),a=i.is(R.checkbox),c=i.is(R.radio),l=-1!==r.indexOf("[]"),u=a?i.is(":checked"):!1;r&&(l?(r=r.replace("[]",""),o[r]||(o[r]=[]),a?u?o[r].push(s||!0):o[r].push(!1):o[r].push(s)):c?u&&(o[r]=s):a?u?o[r]=s||!0:o[r]=!1:o[r]=s)}),o}},has:{field:function(e){return q.verbose("Checking for existence of a field with identifier",e),"string"!=typeof e&&q.error(S.identifier,e),m.filter("#"+e).length>0?!0:m.filter('[name="'+e+'"]').length>0?!0:m.filter("[data-"+k.validate+'="'+e+'"]').length>0?!0:!1}},add:{prompt:function(t,n){var i=q.get.field(t),r=i.closest(g),s=r.children(R.prompt),a=0!==s.length;n="string"==typeof n?[n]:n,q.verbose("Adding field error state",t),r.addClass(w.error),x.inline&&(a||(s=x.templates.prompt(n),s.appendTo(r)),s.html(n[0]),a?q.verbose("Inline errors are disabled, no inline error added",t):x.transition&&e.fn.transition!==o&&F.transition("is supported")?(q.verbose("Displaying error with css transition",x.transition),s.transition(x.transition+" in",x.duration)):(q.verbose("Displaying error with fallback javascript animation"),s.fadeIn(x.duration)))},errors:function(e){q.debug("Adding form error messages",e),q.set.error(),p.html(x.templates.error(e))}},remove:{prompt:function(t){var n=q.get.field(t),i=n.closest(g),r=i.children(R.prompt);i.removeClass(w.error),x.inline&&r.is(":visible")&&(q.verbose("Removing prompt for field",t),x.transition&&e.fn.transition!==o&&F.transition("is supported")?r.transition(x.transition+" out",x.duration,function(){r.remove()}):r.fadeOut(x.duration,function(){r.remove()}))}},set:{success:function(){F.removeClass(w.error).addClass(w.success)},defaults:function(){m.each(function(){var t=e(this),n=t.filter(R.checkbox).length>0,o=n?t.is(":checked"):t.val();t.data(k.defaultValue,o)})},error:function(){F.removeClass(w.success).addClass(w.error)},value:function(e,t){var n={};return n[e]=t,q.set.values.call(j,n)},values:function(t){e.isEmptyObject(t)||e.each(t,function(t,n){var o,i=q.get.field(t),r=i.parent(),s=e.isArray(n),a=r.is(R.uiCheckbox),c=r.is(R.uiDropdown),l=i.is(R.radio)&&a,u=i.length>0;u&&(s&&a?(q.verbose("Selecting multiple",n,i),r.checkbox("uncheck"),e.each(n,function(e,t){o=i.filter('[value="'+t+'"]'),r=o.parent(),o.length>0&&r.checkbox("check")})):l?(q.verbose("Selecting radio value",n,i),i.filter('[value="'+n+'"]').parent(R.uiCheckbox).checkbox("check")):a?(q.verbose("Setting checkbox value",n,r),n===!0?r.checkbox("check"):r.checkbox("uncheck")):c?(q.verbose("Setting dropdown value",n,r),r.dropdown("set selected",n)):(q.verbose("Setting field value",n,i),i.val(n)))})}},validate:{form:function(e,t){var n=q.get.values();if(z)return!1;if(O=[],q.is.valid()){if(q.debug("Form has no validation errors, submitting"),q.set.success(),t!==!0)return x.onSuccess.call(j,e,n)}else if(q.debug("Form has errors"),q.set.error(),x.inline||q.add.errors(O),F.data("moduleApi")!==o&&e.stopImmediatePropagation(),t!==!0)return x.onFailure.call(j,O,n)},field:function(t,n){var i=t.identifier||n,r=q.get.field(i),s=!0,a=[];return t.identifier||(q.debug("Using field name as identifier",i),t.identifier=i),r.prop("disabled")?(q.debug("Field is disabled. Skipping",i),s=!0):t.optional&&""===e.trim(r.val())?(q.debug("Field is optional and empty. Skipping",i),s=!0):t.rules!==o&&e.each(t.rules,function(e,n){q.has.field(i)&&!q.validate.rule(t,n)&&(q.debug("Field is invalid",i,n.type),a.push(q.get.prompt(n,t)),s=!1)}),s?(q.remove.prompt(i,a),x.onValid.call(r),!0):(O=O.concat(a),q.add.prompt(i,a),x.onInvalid.call(r,a),!1)},rule:function(t,n){var i=q.get.field(t.identifier),r=(n.type,i.val()),s=q.get.ancillaryValue(n),a=q.get.ruleName(n),c=x.rules[a];return e.isFunction(c)?(r=r===o||""===r||null===r?"":e.trim(r+""),c.call(i,r,s)):void q.error(S.noRule,a)}},setting:function(t,n){if(e.isPlainObject(t))e.extend(!0,x,t);else{if(n===o)return x[t];x[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,q,t);else{if(n===o)return q[t];q[t]=n}},debug:function(){x.debug&&(x.performance?q.performance.log(arguments):(q.debug=Function.prototype.bind.call(console.info,console,x.name+":"),q.debug.apply(console,arguments)))},verbose:function(){x.verbose&&x.debug&&(x.performance?q.performance.log(arguments):(q.verbose=Function.prototype.bind.call(console.info,console,x.name+":"),q.verbose.apply(console,arguments)))},error:function(){q.error=Function.prototype.bind.call(console.error,console,x.name+":"),q.error.apply(console,arguments)},performance:{log:function(e){var t,n,o;x.performance&&(t=(new Date).getTime(),o=a||t,n=t-o,a=t,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:j,"Execution Time":n})),clearTimeout(q.performance.timer),q.performance.timer=setTimeout(q.performance.display,500)},display:function(){var t=x.name+":",n=0;a=!1,clearTimeout(q.performance.timer),e.each(c,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",s&&(t+=" '"+s+"'"),r.length>1&&(t+=" ("+r.length+")"),(console.group!==o||console.table!==o)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,n,r){var s,a,c,l=A;return n=n||f,r=j||r,"string"==typeof t&&l!==o&&(t=t.split(/[\. ]/),s=t.length-1,e.each(t,function(n,i){var r=n!=s?i+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(l[r])&&n!=s)l=l[r];else{if(l[r]!==o)return a=l[r],!1;if(!e.isPlainObject(l[i])||n==s)return l[i]!==o?(a=l[i],!1):!1;l=l[i]}})),e.isFunction(a)?c=a.apply(r,n):a!==o&&(c=a),e.isArray(i)?i.push(c):i!==o?i=[i,c]:c!==o&&(i=c),a}},q.initialize()}),i!==o?i:this},e.fn.form.settings={name:"Form",namespace:"form",debug:!1,verbose:!1,performance:!0,fields:!1,keyboardShortcuts:!0,on:"submit",inline:!1,delay:200,revalidate:!0,transition:"scale",duration:200,onValid:function(){},onInvalid:function(){},onSuccess:function(){return!0},onFailure:function(){return!1},metadata:{defaultValue:"default",validate:"validate"},regExp:{bracket:/\[(.*)\]/i,decimal:/^\-?\d*(\.\d+)?$/,email:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,flags:/^\/(.*)\/(.*)?/,integer:/^\-?\d+$/,number:/^\-?\d*(\.\d+)?$/,url:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/i},text:{unspecifiedRule:"Please enter a valid value",unspecifiedField:"This field"},prompt:{empty:"{name} must have a value",checked:"{name} must be checked",email:"{name} must be a valid e-mail",url:"{name} must be a valid url",regExp:"{name} is not formatted correctly",integer:"{name} must be an integer",decimal:"{name} must be a decimal number",number:"{name} must be set to a number",is:'{name} must be "{ruleValue}"',isExactly:'{name} must be exactly "{ruleValue}"',not:'{name} cannot be set to "{ruleValue}"',notExactly:'{name} cannot be set to exactly "{ruleValue}"',contain:'{name} cannot contain "{ruleValue}"',containExactly:'{name} cannot contain exactly "{ruleValue}"',doesntContain:'{name} must contain  "{ruleValue}"',doesntContainExactly:'{name} must contain exactly "{ruleValue}"',minLength:"{name} must be at least {ruleValue} characters",length:"{name} must be at least {ruleValue} characters",exactLength:"{name} must be exactly {ruleValue} characters",maxLength:"{name} cannot be longer than {ruleValue} characters",match:"{name} must match {ruleValue} field",different:"{name} must have a different value than {ruleValue} field",creditCard:"{name} must be a valid credit card number",minCount:"{name} must have at least {ruleValue} choices",exactCount:"{name} must have exactly {ruleValue} choices",maxCount:"{name} must have {ruleValue} or less choices"},selector:{checkbox:'input[type="checkbox"], input[type="radio"]',clear:".clear",field:"input, textarea, select",group:".field",input:"input",message:".error.message",prompt:".prompt.label",radio:'input[type="radio"]',reset:'.reset:not([type="reset"])',submit:'.submit:not([type="submit"])',uiCheckbox:".ui.checkbox",uiDropdown:".ui.dropdown"},className:{error:"error",label:"ui prompt label",pressed:"down",success:"success"},error:{identifier:"You must specify a string identifier for each field",method:"The method you called is not defined.",noRule:"There is no rule matching the one you specified",oldSyntax:"Starting in 2.0 forms now only take a single settings object. Validation settings converted to new syntax automatically."},templates:{error:function(t){var n='<ul class="list">';return e.each(t,function(e,t){n+="<li>"+t+"</li>"}),n+="</ul>",e(n)},prompt:function(t){return e("<div/>").addClass("ui basic red pointing prompt label").html(t[0])}},rules:{empty:function(t){return!(t===o||""===t||e.isArray(t)&&0===t.length)},checked:function(){return e(this).filter(":checked").length>0},email:function(t){var n=new RegExp(e.fn.form.settings.regExp.email,"i");return n.test(t)},url:function(t){return e.fn.form.settings.regExp.url.test(t)},regExp:function(t,n){var o,i=n.match(e.fn.form.settings.regExp.flags);return i&&(n=i.length>=2?i[1]:n,o=i.length>=3?i[2]:""),t.match(new RegExp(n,o))},integer:function(t,n){var i,r,s,a=e.fn.form.settings.regExp.integer;return n===o||""===n||".."===n||(-1==n.indexOf("..")?a.test(n)&&(i=r=n-0):(s=n.split("..",2),a.test(s[0])&&(i=s[0]-0),a.test(s[1])&&(r=s[1]-0))),a.test(t)&&(i===o||t>=i)&&(r===o||r>=t)},decimal:function(t){return e.fn.form.settings.regExp.decimal.test(t)},number:function(t){return e.fn.form.settings.regExp.number.test(t)},is:function(e,t){return t="string"==typeof t?t.toLowerCase():t,e="string"==typeof e?e.toLowerCase():e,e==t},isExactly:function(e,t){return e==t},not:function(e,t){return e="string"==typeof e?e.toLowerCase():e,t="string"==typeof t?t.toLowerCase():t,e!=t},notExactly:function(e,t){return e!=t},contains:function(t,n){return n=n.replace(e.fn.form.settings.regExp.escape,"\\$&"),-1!==t.search(new RegExp(n,"i"))},containsExactly:function(t,n){return n=n.replace(e.fn.form.settings.regExp.escape,"\\$&"),-1!==t.search(new RegExp(n))},doesntContain:function(t,n){return n=n.replace(e.fn.form.settings.regExp.escape,"\\$&"),-1===t.search(new RegExp(n,"i"))},doesntContainExactly:function(t,n){return n=n.replace(e.fn.form.settings.regExp.escape,"\\$&"),-1===t.search(new RegExp(n))},minLength:function(e,t){return e!==o?e.length>=t:!1},length:function(e,t){return e!==o?e.length>=t:!1},exactLength:function(e,t){return e!==o?e.length==t:!1},maxLength:function(e,t){return e!==o?e.length<=t:!1},match:function(t,n){var i;e(this);return e('[data-validate="'+n+'"]').length>0?i=e('[data-validate="'+n+'"]').val():e("#"+n).length>0?i=e("#"+n).val():e('[name="'+n+'"]').length>0?i=e('[name="'+n+'"]').val():e('[name="'+n+'[]"]').length>0&&(i=e('[name="'+n+'[]"]')),i!==o?t.toString()==i.toString():!1},different:function(t,n){var i;e(this);return e('[data-validate="'+n+'"]').length>0?i=e('[data-validate="'+n+'"]').val():e("#"+n).length>0?i=e("#"+n).val():e('[name="'+n+'"]').length>0?i=e('[name="'+n+'"]').val():e('[name="'+n+'[]"]').length>0&&(i=e('[name="'+n+'[]"]')),i!==o?t.toString()!==i.toString():!1},creditCard:function(t,n){var o,i,r={visa:{pattern:/^4/,length:[16]},amex:{pattern:/^3[47]/,length:[15]},mastercard:{pattern:/^5[1-5]/,length:[16]},discover:{pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,length:[16]},unionPay:{pattern:/^(62|88)/,length:[16,17,18,19]},jcb:{pattern:/^35(2[89]|[3-8][0-9])/,length:[16]},maestro:{pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,
length:[12,13,14,15,16,17,18,19]},dinersClub:{pattern:/^(30[0-5]|^36)/,length:[14]},laser:{pattern:/^(6304|670[69]|6771)/,length:[16,17,18,19]},visaElectron:{pattern:/^(4026|417500|4508|4844|491(3|7))/,length:[16]}},s={},a=!1,c="string"==typeof n?n.split(","):!1;if("string"==typeof t&&0!==t.length){if(c&&(e.each(c,function(n,o){i=r[o],i&&(s={length:-1!==e.inArray(t.length,i.length),pattern:-1!==t.search(i.pattern)},s.length&&s.pattern&&(a=!0))}),!a))return!1;if(o={number:-1!==e.inArray(t.length,r.unionPay.length),pattern:-1!==t.search(r.unionPay.pattern)},o.number&&o.pattern)return!0;for(var l=t.length,u=0,d=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],f=0;l--;)f+=d[u][parseInt(t.charAt(l),10)],u^=1;return f%10===0&&f>0}},minCount:function(e,t){return 0==t?!0:1==t?""!==e:e.split(",").length>=t},exactCount:function(e,t){return 0==t?""===e:1==t?""!==e&&-1===e.search(","):e.split(",").length==t},maxCount:function(e,t){return 0==t?!1:1==t?-1===e.search(","):e.split(",").length<=t}}}}(jQuery,window,document),function(e,t,n,o){"use strict";e.fn.state=function(t){var i,r=e(this),s=r.selector||"",a=("ontouchstart"in n.documentElement,(new Date).getTime()),c=[],l=arguments[0],u="string"==typeof l,d=[].slice.call(arguments,1);return r.each(function(){var n,f=e.isPlainObject(t)?e.extend(!0,{},e.fn.state.settings,t):e.extend({},e.fn.state.settings),m=f.error,g=f.metadata,p=f.className,v=f.namespace,b=f.states,h=f.text,y="."+v,x=v+"-module",C=e(this),k=this,R=C.data(x);n={initialize:function(){n.verbose("Initializing module"),f.automatic&&n.add.defaults(),f.context&&""!==s?e(f.context).on(s,"mouseenter"+y,n.change.text).on(s,"mouseleave"+y,n.reset.text).on(s,"click"+y,n.toggle.state):C.on("mouseenter"+y,n.change.text).on("mouseleave"+y,n.reset.text).on("click"+y,n.toggle.state),n.instantiate()},instantiate:function(){n.verbose("Storing instance of module",n),R=n,C.data(x,n)},destroy:function(){n.verbose("Destroying previous module",R),C.off(y).removeData(x)},refresh:function(){n.verbose("Refreshing selector cache"),C=e(k)},add:{defaults:function(){var i=t&&e.isPlainObject(t.states)?t.states:{};e.each(f.defaults,function(t,r){n.is[t]!==o&&n.is[t]()&&(n.verbose("Adding default states",t,k),e.extend(f.states,r,i))})}},is:{active:function(){return C.hasClass(p.active)},loading:function(){return C.hasClass(p.loading)},inactive:function(){return!C.hasClass(p.active)},state:function(e){return p[e]===o?!1:C.hasClass(p[e])},enabled:function(){return!C.is(f.filter.active)},disabled:function(){return C.is(f.filter.active)},textEnabled:function(){return!C.is(f.filter.text)},button:function(){return C.is(".button:not(a, .submit)")},input:function(){return C.is("input")},progress:function(){return C.is(".ui.progress")}},allow:function(e){n.debug("Now allowing state",e),b[e]=!0},disallow:function(e){n.debug("No longer allowing",e),b[e]=!1},allows:function(e){return b[e]||!1},enable:function(){C.removeClass(p.disabled)},disable:function(){C.addClass(p.disabled)},setState:function(e){n.allows(e)&&C.addClass(p[e])},removeState:function(e){n.allows(e)&&C.removeClass(p[e])},toggle:{state:function(){var t,i;if(n.allows("active")&&n.is.enabled()){if(n.refresh(),e.fn.api!==o)if(t=C.api("get request"),i=C.api("was cancelled"))n.debug("API Request cancelled by beforesend"),f.activateTest=function(){return!1},f.deactivateTest=function(){return!1};else if(t)return void n.listenTo(t);n.change.state()}}},listenTo:function(t){n.debug("API request detected, waiting for state signal",t),t&&(h.loading&&n.update.text(h.loading),e.when(t).then(function(){"resolved"==t.state()?(n.debug("API request succeeded"),f.activateTest=function(){return!0},f.deactivateTest=function(){return!0}):(n.debug("API request failed"),f.activateTest=function(){return!1},f.deactivateTest=function(){return!1}),n.change.state()}))},change:{state:function(){n.debug("Determining state change direction"),n.is.inactive()?n.activate():n.deactivate(),f.sync&&n.sync(),f.onChange.call(k)},text:function(){n.is.textEnabled()&&(n.is.disabled()?(n.verbose("Changing text to disabled text",h.hover),n.update.text(h.disabled)):n.is.active()?h.hover?(n.verbose("Changing text to hover text",h.hover),n.update.text(h.hover)):h.deactivate&&(n.verbose("Changing text to deactivating text",h.deactivate),n.update.text(h.deactivate)):h.hover?(n.verbose("Changing text to hover text",h.hover),n.update.text(h.hover)):h.activate&&(n.verbose("Changing text to activating text",h.activate),n.update.text(h.activate)))}},activate:function(){f.activateTest.call(k)&&(n.debug("Setting state to active"),C.addClass(p.active),n.update.text(h.active),f.onActivate.call(k))},deactivate:function(){f.deactivateTest.call(k)&&(n.debug("Setting state to inactive"),C.removeClass(p.active),n.update.text(h.inactive),f.onDeactivate.call(k))},sync:function(){n.verbose("Syncing other buttons to current state"),n.is.active()?r.not(C).state("activate"):r.not(C).state("deactivate")},get:{text:function(){return f.selector.text?C.find(f.selector.text).text():C.html()},textFor:function(e){return h[e]||!1}},flash:{text:function(e,t,o){var i=n.get.text();n.debug("Flashing text message",e,t),e=e||f.text.flash,t=t||f.flashDuration,o=o||function(){},n.update.text(e),setTimeout(function(){n.update.text(i),o.call(k)},t)}},reset:{text:function(){var e=h.active||C.data(g.storedText),t=h.inactive||C.data(g.storedText);n.is.textEnabled()&&(n.is.active()&&e?(n.verbose("Resetting active text",e),n.update.text(e)):t&&(n.verbose("Resetting inactive text",e),n.update.text(t)))}},update:{text:function(e){var t=n.get.text();e&&e!==t?(n.debug("Updating text",e),f.selector.text?C.data(g.storedText,e).find(f.selector.text).text(e):C.data(g.storedText,e).html(e)):n.debug("Text is already set, ignoring update",e)}},setting:function(t,i){if(n.debug("Changing setting",t,i),e.isPlainObject(t))e.extend(!0,f,t);else{if(i===o)return f[t];f[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,n,t);else{if(i===o)return n[t];n[t]=i}},debug:function(){f.debug&&(f.performance?n.performance.log(arguments):(n.debug=Function.prototype.bind.call(console.info,console,f.name+":"),n.debug.apply(console,arguments)))},verbose:function(){f.verbose&&f.debug&&(f.performance?n.performance.log(arguments):(n.verbose=Function.prototype.bind.call(console.info,console,f.name+":"),n.verbose.apply(console,arguments)))},error:function(){n.error=Function.prototype.bind.call(console.error,console,f.name+":"),n.error.apply(console,arguments)},performance:{log:function(e){var t,o,i;f.performance&&(t=(new Date).getTime(),i=a||t,o=t-i,a=t,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:k,"Execution Time":o})),clearTimeout(n.performance.timer),n.performance.timer=setTimeout(n.performance.display,500)},display:function(){var t=f.name+":",i=0;a=!1,clearTimeout(n.performance.timer),e.each(c,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",s&&(t+=" '"+s+"'"),(console.group!==o||console.table!==o)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,r,s){var a,c,l,u=R;return r=r||d,s=k||s,"string"==typeof t&&u!==o&&(t=t.split(/[\. ]/),a=t.length-1,e.each(t,function(i,r){var s=i!=a?r+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(e.isPlainObject(u[s])&&i!=a)u=u[s];else{if(u[s]!==o)return c=u[s],!1;if(!e.isPlainObject(u[r])||i==a)return u[r]!==o?(c=u[r],!1):(n.error(m.method,t),!1);u=u[r]}})),e.isFunction(c)?l=c.apply(s,r):c!==o&&(l=c),e.isArray(i)?i.push(l):i!==o?i=[i,l]:l!==o&&(i=l),c}},u?(R===o&&n.initialize(),n.invoke(l)):(R!==o&&R.invoke("destroy"),n.initialize())}),i!==o?i:this},e.fn.state.settings={name:"State",debug:!1,verbose:!1,namespace:"state",performance:!0,onActivate:function(){},onDeactivate:function(){},onChange:function(){},activateTest:function(){return!0},deactivateTest:function(){return!0},automatic:!0,sync:!1,flashDuration:1e3,filter:{text:".loading, .disabled",active:".disabled"},context:!1,error:{beforeSend:"The before send function has cancelled state change",method:"The method you called is not defined."},metadata:{promise:"promise",storedText:"stored-text"},className:{active:"active",disabled:"disabled",error:"error",loading:"loading",success:"success",warning:"warning"},selector:{text:!1},defaults:{input:{disabled:!0,loading:!0,active:!0},button:{disabled:!0,loading:!0,active:!0},progress:{active:!0,success:!0,warning:!0,error:!0}},states:{active:!0,disabled:!0,error:!0,loading:!0,success:!0,warning:!0},text:{disabled:!1,flash:!1,hover:!1,active:!1,inactive:!1,activate:!1,deactivate:!1}}}(jQuery,window,document),function(e,t,n,o){"use strict";e.fn.visibility=function(i){var r,s=e(this),a=s.selector||"",c=(new Date).getTime(),l=[],u=arguments[0],d="string"==typeof u,f=[].slice.call(arguments,1);return s.each(function(){var s,m,g,p=e.isPlainObject(i)?e.extend(!0,{},e.fn.visibility.settings,i):e.extend({},e.fn.visibility.settings),v=p.className,b=p.namespace,h=p.error,y=p.metadata,x="."+b,C="module-"+b,k=e(t),R=e(this),w=e(p.context),S=(R.selector||"",R.data(C)),T=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)},P=this,E=!1;g={initialize:function(){g.debug("Initializing",p),g.setup.cache(),g.should.trackChanges()&&("image"==p.type&&g.setup.image(),"fixed"==p.type&&g.setup.fixed(),p.observeChanges&&g.observeChanges(),g.bind.events()),g.save.position(),g.is.visible()||g.error(h.visible,R),p.initialCheck&&g.checkVisibility(),g.instantiate()},instantiate:function(){g.debug("Storing instance",g),R.data(C,g),S=g},destroy:function(){g.verbose("Destroying previous module"),m&&m.disconnect(),k.off("load"+x,g.event.load).off("resize"+x,g.event.resize),w.off("scrollchange"+x,g.event.scrollchange),R.off(x).removeData(C)},observeChanges:function(){"MutationObserver"in t&&(m=new MutationObserver(function(e){g.verbose("DOM tree modified, updating visibility calculations"),g.timer=setTimeout(function(){g.verbose("DOM tree modified, updating sticky menu"),g.refresh()},100)}),m.observe(P,{childList:!0,subtree:!0}),g.debug("Setting up mutation observer",m))},bind:{events:function(){g.verbose("Binding visibility events to scroll and resize"),p.refreshOnLoad&&k.on("load"+x,g.event.load),k.on("resize"+x,g.event.resize),w.off("scroll"+x).on("scroll"+x,g.event.scroll).on("scrollchange"+x,g.event.scrollchange)}},event:{resize:function(){g.debug("Window resized"),p.refreshOnResize&&T(g.refresh)},load:function(){g.debug("Page finished loading"),T(g.refresh)},scroll:function(){p.throttle?(clearTimeout(g.timer),g.timer=setTimeout(function(){w.triggerHandler("scrollchange"+x,[w.scrollTop()])},p.throttle)):T(function(){w.triggerHandler("scrollchange"+x,[w.scrollTop()])})},scrollchange:function(e,t){g.checkVisibility(t)}},precache:function(t,o){t instanceof Array||(t=[t]);for(var i=t.length,r=0,s=[],a=n.createElement("img"),c=function(){r++,r>=t.length&&e.isFunction(o)&&o()};i--;)a=n.createElement("img"),a.onload=c,a.onerror=c,a.src=t[i],s.push(a)},enableCallbacks:function(){g.debug("Allowing callbacks to occur"),E=!1},disableCallbacks:function(){g.debug("Disabling all callbacks temporarily"),E=!0},should:{trackChanges:function(){return d?(g.debug("One time query, no need to bind events"),!1):(g.debug("Callbacks being attached"),!0)}},setup:{cache:function(){g.cache={occurred:{},screen:{},element:{}}},image:function(){var e=R.data(y.src);e&&(g.verbose("Lazy loading image",e),p.once=!0,p.observeChanges=!1,p.onOnScreen=function(){g.debug("Image on screen",P),g.precache(e,function(){g.set.image(e)})})},fixed:function(){g.debug("Setting up fixed"),p.once=!1,p.observeChanges=!1,p.initialCheck=!0,p.refreshOnLoad=!0,i.transition||(p.transition=!1),g.create.placeholder(),g.debug("Added placeholder",s),p.onTopPassed=function(){g.debug("Element passed, adding fixed position",R),g.show.placeholder(),g.set.fixed(),p.transition&&e.fn.transition!==o&&R.transition(p.transition,p.duration)},p.onTopPassedReverse=function(){g.debug("Element returned to position, removing fixed",R),g.hide.placeholder(),g.remove.fixed()}}},create:{placeholder:function(){g.verbose("Creating fixed position placeholder"),s=R.clone(!1).css("display","none").addClass(v.placeholder).insertAfter(R)}},show:{placeholder:function(){g.verbose("Showing placeholder"),s.css("display","block").css("visibility","hidden")}},hide:{placeholder:function(){g.verbose("Hiding placeholder"),s.css("display","none").css("visibility","")}},set:{fixed:function(){g.verbose("Setting element to fixed position"),R.addClass(v.fixed).css({position:"fixed",top:p.offset+"px",left:"auto",zIndex:"1"})},image:function(t){R.attr("src",t),p.transition?e.fn.transition!==o?R.transition(p.transition,p.duration):R.fadeIn(p.duration):R.show()}},is:{onScreen:function(){var e=g.get.elementCalculations();return e.onScreen},offScreen:function(){var e=g.get.elementCalculations();return e.offScreen},visible:function(){return g.cache&&g.cache.element?!(0===g.cache.element.width&&0===g.cache.element.offset.top):!1}},refresh:function(){g.debug("Refreshing constants (width/height)"),"fixed"==p.type&&(g.remove.fixed(),g.remove.occurred()),g.reset(),g.save.position(),p.checkOnRefresh&&g.checkVisibility(),p.onRefresh.call(P)},reset:function(){g.verbose("Reseting all cached values"),e.isPlainObject(g.cache)&&(g.cache.screen={},g.cache.element={})},checkVisibility:function(e){g.verbose("Checking visibility of element",g.cache.element),!E&&g.is.visible()&&(g.save.scroll(e),g.save.calculations(),g.passed(),g.passingReverse(),g.topVisibleReverse(),g.bottomVisibleReverse(),g.topPassedReverse(),g.bottomPassedReverse(),g.onScreen(),g.offScreen(),g.passing(),g.topVisible(),g.bottomVisible(),g.topPassed(),g.bottomPassed(),p.onUpdate&&p.onUpdate.call(P,g.get.elementCalculations()))},passed:function(t,n){var i=g.get.elementCalculations();if(t&&n)p.onPassed[t]=n;else{if(t!==o)return g.get.pixelsPassed(t)>i.pixelsPassed;i.passing&&e.each(p.onPassed,function(e,t){i.bottomVisible||i.pixelsPassed>g.get.pixelsPassed(e)?g.execute(t,e):p.once||g.remove.occurred(t)})}},onScreen:function(e){var t=g.get.elementCalculations(),n=e||p.onOnScreen,i="onScreen";return e&&(g.debug("Adding callback for onScreen",e),p.onOnScreen=e),t.onScreen?g.execute(n,i):p.once||g.remove.occurred(i),e!==o?t.onOnScreen:void 0},offScreen:function(e){var t=g.get.elementCalculations(),n=e||p.onOffScreen,i="offScreen";return e&&(g.debug("Adding callback for offScreen",e),p.onOffScreen=e),t.offScreen?g.execute(n,i):p.once||g.remove.occurred(i),e!==o?t.onOffScreen:void 0},passing:function(e){var t=g.get.elementCalculations(),n=e||p.onPassing,i="passing";return e&&(g.debug("Adding callback for passing",e),p.onPassing=e),t.passing?g.execute(n,i):p.once||g.remove.occurred(i),e!==o?t.passing:void 0},topVisible:function(e){var t=g.get.elementCalculations(),n=e||p.onTopVisible,i="topVisible";return e&&(g.debug("Adding callback for top visible",e),p.onTopVisible=e),t.topVisible?g.execute(n,i):p.once||g.remove.occurred(i),e===o?t.topVisible:void 0},bottomVisible:function(e){var t=g.get.elementCalculations(),n=e||p.onBottomVisible,i="bottomVisible";return e&&(g.debug("Adding callback for bottom visible",e),p.onBottomVisible=e),t.bottomVisible?g.execute(n,i):p.once||g.remove.occurred(i),e===o?t.bottomVisible:void 0},topPassed:function(e){var t=g.get.elementCalculations(),n=e||p.onTopPassed,i="topPassed";return e&&(g.debug("Adding callback for top passed",e),p.onTopPassed=e),t.topPassed?g.execute(n,i):p.once||g.remove.occurred(i),e===o?t.topPassed:void 0},bottomPassed:function(e){var t=g.get.elementCalculations(),n=e||p.onBottomPassed,i="bottomPassed";return e&&(g.debug("Adding callback for bottom passed",e),p.onBottomPassed=e),t.bottomPassed?g.execute(n,i):p.once||g.remove.occurred(i),e===o?t.bottomPassed:void 0},passingReverse:function(e){var t=g.get.elementCalculations(),n=e||p.onPassingReverse,i="passingReverse";return e&&(g.debug("Adding callback for passing reverse",e),p.onPassingReverse=e),t.passing?p.once||g.remove.occurred(i):g.get.occurred("passing")&&g.execute(n,i),e!==o?!t.passing:void 0},topVisibleReverse:function(e){var t=g.get.elementCalculations(),n=e||p.onTopVisibleReverse,i="topVisibleReverse";return e&&(g.debug("Adding callback for top visible reverse",e),p.onTopVisibleReverse=e),t.topVisible?p.once||g.remove.occurred(i):g.get.occurred("topVisible")&&g.execute(n,i),e===o?!t.topVisible:void 0},bottomVisibleReverse:function(e){var t=g.get.elementCalculations(),n=e||p.onBottomVisibleReverse,i="bottomVisibleReverse";return e&&(g.debug("Adding callback for bottom visible reverse",e),p.onBottomVisibleReverse=e),t.bottomVisible?p.once||g.remove.occurred(i):g.get.occurred("bottomVisible")&&g.execute(n,i),e===o?!t.bottomVisible:void 0},topPassedReverse:function(e){var t=g.get.elementCalculations(),n=e||p.onTopPassedReverse,i="topPassedReverse";return e&&(g.debug("Adding callback for top passed reverse",e),p.onTopPassedReverse=e),t.topPassed?p.once||g.remove.occurred(i):g.get.occurred("topPassed")&&g.execute(n,i),e===o?!t.onTopPassed:void 0},bottomPassedReverse:function(e){var t=g.get.elementCalculations(),n=e||p.onBottomPassedReverse,i="bottomPassedReverse";return e&&(g.debug("Adding callback for bottom passed reverse",e),p.onBottomPassedReverse=e),t.bottomPassed?p.once||g.remove.occurred(i):g.get.occurred("bottomPassed")&&g.execute(n,i),e===o?!t.bottomPassed:void 0},execute:function(e,t){var n=g.get.elementCalculations(),o=g.get.screenCalculations();e=e||!1,e&&(p.continuous?(g.debug("Callback being called continuously",t,n),e.call(P,n,o)):g.get.occurred(t)||(g.debug("Conditions met",t,n),e.call(P,n,o))),g.save.occurred(t)},remove:{fixed:function(){g.debug("Removing fixed position"),R.removeClass(v.fixed).css({position:"",top:"",left:"",zIndex:""})},occurred:function(e){if(e){var t=g.cache.occurred;t[e]!==o&&t[e]===!0&&(g.debug("Callback can now be called again",e),g.cache.occurred[e]=!1)}else g.cache.occurred={}}},save:{calculations:function(){g.verbose("Saving all calculations necessary to determine positioning"),g.save.direction(),g.save.screenCalculations(),g.save.elementCalculations()},occurred:function(e){e&&(g.cache.occurred[e]===o||g.cache.occurred[e]!==!0)&&(g.verbose("Saving callback occurred",e),g.cache.occurred[e]=!0)},scroll:function(e){e=e+p.offset||w.scrollTop()+p.offset,g.cache.scroll=e},direction:function(){var e,t=g.get.scroll(),n=g.get.lastScroll();return e=t>n&&n?"down":n>t&&n?"up":"static",g.cache.direction=e,g.cache.direction},elementPosition:function(){var e=g.cache.element,t=g.get.screenSize();return g.verbose("Saving element position"),e.fits=e.height<t.height,e.offset=R.offset(),e.width=R.outerWidth(),e.height=R.outerHeight(),g.cache.element=e,e},elementCalculations:function(){var e=g.get.screenCalculations(),t=g.get.elementPosition();return p.includeMargin?(t.margin={},t.margin.top=parseInt(R.css("margin-top"),10),t.margin.bottom=parseInt(R.css("margin-bottom"),10),t.top=t.offset.top-t.margin.top,t.bottom=t.offset.top+t.height+t.margin.bottom):(t.top=t.offset.top,t.bottom=t.offset.top+t.height),t.topVisible=e.bottom>=t.top,t.topPassed=e.top>=t.top,t.bottomVisible=e.bottom>=t.bottom,t.bottomPassed=e.top>=t.bottom,t.pixelsPassed=0,t.percentagePassed=0,t.onScreen=t.topVisible&&!t.bottomPassed,t.passing=t.topPassed&&!t.bottomPassed,t.offScreen=!t.onScreen,t.passing&&(t.pixelsPassed=e.top-t.top,t.percentagePassed=(e.top-t.top)/t.height),g.cache.element=t,g.verbose("Updated element calculations",t),t},screenCalculations:function(){var e=g.get.scroll();return g.save.direction(),g.cache.screen.top=e,g.cache.screen.bottom=e+g.cache.screen.height,g.cache.screen},screenSize:function(){g.verbose("Saving window position"),g.cache.screen={height:w.height()}},position:function(){g.save.screenSize(),g.save.elementPosition()}},get:{pixelsPassed:function(e){var t=g.get.elementCalculations();return e.search("%")>-1?t.height*(parseInt(e,10)/100):parseInt(e,10)},occurred:function(e){return g.cache.occurred!==o?g.cache.occurred[e]||!1:!1},direction:function(){return g.cache.direction===o&&g.save.direction(),g.cache.direction},elementPosition:function(){return g.cache.element===o&&g.save.elementPosition(),g.cache.element},elementCalculations:function(){return g.cache.element===o&&g.save.elementCalculations(),g.cache.element},screenCalculations:function(){return g.cache.screen===o&&g.save.screenCalculations(),g.cache.screen},screenSize:function(){return g.cache.screen===o&&g.save.screenSize(),g.cache.screen},scroll:function(){return g.cache.scroll===o&&g.save.scroll(),g.cache.scroll},lastScroll:function(){return g.cache.screen===o?(g.debug("First scroll event, no last scroll could be found"),!1):g.cache.screen.top}},setting:function(t,n){if(e.isPlainObject(t))e.extend(!0,p,t);else{if(n===o)return p[t];p[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,g,t);else{if(n===o)return g[t];g[t]=n}},debug:function(){p.debug&&(p.performance?g.performance.log(arguments):(g.debug=Function.prototype.bind.call(console.info,console,p.name+":"),g.debug.apply(console,arguments)))},verbose:function(){p.verbose&&p.debug&&(p.performance?g.performance.log(arguments):(g.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),g.verbose.apply(console,arguments)))},error:function(){g.error=Function.prototype.bind.call(console.error,console,p.name+":"),g.error.apply(console,arguments)},performance:{log:function(e){var t,n,o;p.performance&&(t=(new Date).getTime(),o=c||t,n=t-o,c=t,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:P,"Execution Time":n})),clearTimeout(g.performance.timer),g.performance.timer=setTimeout(g.performance.display,500)},display:function(){var t=p.name+":",n=0;c=!1,clearTimeout(g.performance.timer),e.each(l,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",a&&(t+=" '"+a+"'"),(console.group!==o||console.table!==o)&&l.length>0&&(console.groupCollapsed(t),console.table?console.table(l):e.each(l,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(t,n,i){var s,a,c,l=S;return n=n||f,i=P||i,"string"==typeof t&&l!==o&&(t=t.split(/[\. ]/),s=t.length-1,e.each(t,function(n,i){var r=n!=s?i+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(l[r])&&n!=s)l=l[r];else{if(l[r]!==o)return a=l[r],!1;if(!e.isPlainObject(l[i])||n==s)return l[i]!==o?(a=l[i],!1):(g.error(h.method,t),!1);l=l[i]}})),e.isFunction(a)?c=a.apply(i,n):a!==o&&(c=a),e.isArray(r)?r.push(c):r!==o?r=[r,c]:c!==o&&(r=c),a}},d?(S===o&&g.initialize(),S.save.scroll(),S.save.calculations(),g.invoke(u)):(S!==o&&S.invoke("destroy"),g.initialize())}),r!==o?r:this},e.fn.visibility.settings={name:"Visibility",namespace:"visibility",debug:!1,verbose:!1,performance:!0,observeChanges:!0,initialCheck:!0,refreshOnLoad:!0,refreshOnResize:!0,checkOnRefresh:!0,once:!0,continuous:!1,offset:0,includeMargin:!1,context:t,throttle:!1,type:!1,transition:"fade in",duration:1e3,onPassed:{},onOnScreen:!1,onOffScreen:!1,onPassing:!1,onTopVisible:!1,onBottomVisible:!1,onTopPassed:!1,onBottomPassed:!1,onPassingReverse:!1,onTopVisibleReverse:!1,onBottomVisibleReverse:!1,onTopPassedReverse:!1,onBottomPassedReverse:!1,onUpdate:!1,onRefresh:function(){},metadata:{src:"src"},className:{fixed:"fixed",placeholder:"placeholder"},error:{method:"The method you called is not defined.",visible:"Element is hidden, you must call refresh after element becomes visible"}}}(jQuery,window,document);